{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport { api } from '../api/Intercepter';\nimport UserInfo from \"./userInfo.service\";\nimport router from '../router';\n\nvar setup = function setup(store) {\n  api.interceptors.request.use(function (config) {\n    var token = UserInfo.getLocalAccessToken();\n\n    if (token) {\n      // config.headers[\"Authorization\"] = 'Bearer ' + token;  // for Spring Boot back-end\n      config.headers[\"x-access-token\"] = token; // for Node.js Express back-end\n    }\n\n    return config;\n  }, function (error) {\n    return Promise.reject(error);\n  });\n  api.interceptors.response.use(function (res) {\n    return res;\n  }, /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(err) {\n      var originalConfig;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              originalConfig = err.config;\n\n              if (originalConfig.url !== \"/auth/signin\" && err.response) {\n                // Access Token was expired\n                if (err.response.status === 401 && !originalConfig._retry) {// store.dispatch('logout')\n                  // router.push({ path: '/auth/signin' })\n                }\n              }\n\n              return _context.abrupt(\"return\", Promise.reject(err));\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n};\n\nexport default setup;","map":{"version":3,"names":["api","UserInfo","router","setup","store","interceptors","request","use","config","token","getLocalAccessToken","headers","error","Promise","reject","response","res","err","originalConfig","url","status","_retry"],"sources":["C:/Users/someO/Desktop/vue/osboha-template/src/services/setupInterceptors.js"],"sourcesContent":["import {api} from '../api/Intercepter';\nimport UserInfo from \"./userInfo.service\";\nimport router from '../router'\nconst setup = (store) => {\n  api.interceptors.request.use(\n    (config) => {\n      const token = UserInfo.getLocalAccessToken();\n      if (token) {\n        // config.headers[\"Authorization\"] = 'Bearer ' + token;  // for Spring Boot back-end\n        config.headers[\"x-access-token\"] = token; // for Node.js Express back-end\n      }\n      return config;\n    },\n    (error) => {\n      return Promise.reject(error);\n    }\n  );\n\n  api.interceptors.response.use(\n    (res) => {\n      return res;\n    },\n    async (err) => {\n      const originalConfig = err.config;\n       \n      if (originalConfig.url !== \"/auth/signin\" && err.response) {\n        // Access Token was expired\n \n        if (err.response.status === 401 && !originalConfig._retry) {\n        \n          // store.dispatch('logout')\n          // router.push({ path: '/auth/signin' })\n        }\n      }\n\n      return Promise.reject(err);\n    }\n  );\n};\n\nexport default setup;"],"mappings":";;;AAAA,SAAQA,GAAR,QAAkB,oBAAlB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,MAAP,MAAmB,WAAnB;;AACA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,KAAD,EAAW;EACvBJ,GAAG,CAACK,YAAJ,CAAiBC,OAAjB,CAAyBC,GAAzB,CACE,UAACC,MAAD,EAAY;IACV,IAAMC,KAAK,GAAGR,QAAQ,CAACS,mBAAT,EAAd;;IACA,IAAID,KAAJ,EAAW;MACT;MACAD,MAAM,CAACG,OAAP,CAAe,gBAAf,IAAmCF,KAAnC,CAFS,CAEiC;IAC3C;;IACD,OAAOD,MAAP;EACD,CARH,EASE,UAACI,KAAD,EAAW;IACT,OAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;EACD,CAXH;EAcAZ,GAAG,CAACK,YAAJ,CAAiBU,QAAjB,CAA0BR,GAA1B,CACE,UAACS,GAAD,EAAS;IACP,OAAOA,GAAP;EACD,CAHH;IAAA,sEAIE,iBAAOC,GAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cACQC,cADR,GACyBD,GAAG,CAACT,MAD7B;;cAGE,IAAIU,cAAc,CAACC,GAAf,KAAuB,cAAvB,IAAyCF,GAAG,CAACF,QAAjD,EAA2D;gBACzD;gBAEA,IAAIE,GAAG,CAACF,QAAJ,CAAaK,MAAb,KAAwB,GAAxB,IAA+B,CAACF,cAAc,CAACG,MAAnD,EAA2D,CAEzD;kBACA;gBACD;cACF;;cAXH,iCAaSR,OAAO,CAACC,MAAR,CAAeG,GAAf,CAbT;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CAJF;;IAAA;MAAA;IAAA;EAAA;AAoBD,CAnCD;;AAqCA,eAAed,KAAf"},"metadata":{},"sourceType":"module"}