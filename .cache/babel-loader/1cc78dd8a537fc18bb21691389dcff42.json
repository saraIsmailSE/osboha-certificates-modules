{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport thesisServices from '../../api/thesisServices';\nimport useVuelidate from \"@vuelidate/core\";\nimport { required, integer, requiredIf } from \"@vuelidate/validators\";\nexport default {\n  name: \"UpdateQuestion\",\n  created: function created() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return thesisServices.getById(_this.$route.params.id);\n\n            case 2:\n              _this.thesisToupdate = _context.sent;\n              _this.book = _this.thesisToupdate.user_book.book;\n              _this.thesis.text = _this.thesisToupdate.thesis_text;\n              _this.thesis.ending_page = _this.thesisToupdate.ending_page;\n              _this.thesis.starting_page = _this.thesisToupdate.starting_page;\n              _this.thesis.photos = _this.thesisToupdate.photos;\n              console.log(_this.thesis.photos);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  components: {},\n  setup: function setup() {\n    return {\n      v$: useVuelidate()\n    };\n  },\n  data: function data() {\n    return {\n      loader: false,\n      thesis: {\n        text: \"\",\n        starting_page: \"\",\n        ending_page: \"\",\n        photos: [],\n        image_1: [],\n        image_2: [],\n        pages: 0\n      },\n      book: [],\n      message: '',\n      thesisToupdate: []\n    };\n  },\n  validations: function validations() {\n    return {\n      thesis: {\n        text: {\n          required: required\n        },\n        starting_page: {\n          required: required\n        },\n        ending_page: {\n          required: required\n        },\n        image_1: {\n          required: requiredIf(function (nestedModel) {\n            return this.thesis.image_2.length == 0; // New changes\n          })\n        },\n        image_2: {\n          required: requiredIf(function (nestedModel) {\n            return this.thesis.image_1.length == 0; // New changes\n          })\n        }\n      }\n    };\n  },\n  methods: {\n    addField: function addField(value, fieldType) {\n      fieldType.push({\n        text: \"\"\n      });\n    },\n    removeField: function removeField(index, fieldType) {\n      fieldType.splice(index, 1);\n    },\n    submit: function submit() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var thesis;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this2.v$.$touch();\n\n                if (_this2.v$.thesis.$invalid) {\n                  _context2.next = 15;\n                  break;\n                }\n\n                _this2.message = \"\";\n                _this2.loader = true;\n                _context2.next = 6;\n                return thesisServices.updateThesis(_this2.thesis, _this2.$route.params.id);\n\n              case 6:\n                thesis = _context2.sent;\n                _this2.thesis.text = \"\";\n                _this2.thesis.ending_page = \"\";\n                _this2.thesis.starting_page = \"\";\n                _this2.thesis.image_1 = [];\n                _this2.thesis.image_2 = [];\n\n                _this2.v$.thesis.$reset();\n\n                _this2.loader = false;\n                _this2.message = \"تم التعديل بنجاح\";\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    },\n    back: function back() {\n      this.$router.push({\n        path: \"/user_book/\".concat(this.thesisToupdate.user_book_id)\n      });\n    },\n    resolve_img_url: function resolve_img_url(image) {\n      var url = \"http://127.0.0.1:8000/api/thesises/image?path=\".concat(image.path);\n      return url;\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["thesisServices","useVuelidate","required","integer","requiredIf","name","created","getById","$route","params","id","thesisToupdate","book","user_book","thesis","text","thesis_text","ending_page","starting_page","photos","console","log","components","setup","v$","data","loader","image_1","image_2","pages","message","validations","nestedModel","length","methods","addField","value","fieldType","push","removeField","index","splice","submit","$touch","$invalid","updateThesis","$reset","back","$router","path","user_book_id","resolve_img_url","image","url"],"sourceRoot":"","sources":["C:\\Users\\someO\\Desktop\\vue\\osboha-template\\src\\views\\Theses\\update.vue"],"sourcesContent":["<template>\r\n  <div class=\"col-sm-12 mt-3\">\r\n    <iq-card class=\"iq-card\">\r\n      <div class=\"iq-card-header-toolbar d-flex align-items-center mx-auto\">\r\n        <h3 class=\"text-center mt-3 mb-3\">\r\n          تعديل الاطروحة\r\n        </h3>\r\n      </div>\r\n      <div class=\"iq-card-body p-3\">\r\n        <div class=\"image-block text-center\">\r\n          <img src=\"@/assets/images/update-forms.png\" class=\"img-fluid rounded w-50\" alt=\"blog-img\">\r\n        </div>\r\n\r\n        <div class=\"d-flex align-items-center mt-3\"\r\n          v-if=\"thesisToupdate.status == null || thesisToupdate.status == rejected  \">\r\n          <form @submit.prevent=\"submit\" class=\"post-text ml-3 w-100 row\">\r\n            <div class=\"form-group col-6\">\r\n              <select class=\"form-select\" data-trigger name=\"choices-single-default\" id=\"choices-single-default\"\r\n                v-model=\"v$.thesis.starting_page.$model\">\r\n                <option value=\"\">اختر صفحة البداية</option>\r\n                <option v-for=\"(i, index) in book.pages\" :key=\"index\" :value=\"i\">\r\n                  {{ i }}\r\n                </option>\r\n              </select>\r\n              <small style=\"color:red;\" v-if=\"v$.thesis.starting_page.$error\">الرجاء قم بادخال صفحة البداية</small>\r\n            </div>\r\n            <div class=\"form-group col-6\">\r\n              <select class=\"form-select\" data-trigger name=\"choices-single-default\" id=\"choices-single-default\"\r\n                v-model=\"v$.thesis.ending_page.$model\">\r\n                <option value=\"\">اختر صفحة النهاية</option>\r\n                <option v-for=\"(i, index) in book.pages\" :key=\"index\" :value=\"i\">\r\n                  {{ i }}\r\n                </option>\r\n              </select>\r\n              <small style=\"color:red;\" v-if=\"v$.thesis.ending_page.$error\">الرجاء قم بادخال صفحة النهاية</small>\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label class=\"form-label\" for=\"thesisBody\">الأطروحة</label>\r\n              <textarea rows=\"5\" placeholder=\"... اكتب أطروحتك\" class=\"rounded form-control\" id=\"thesisBody\"\r\n                v-model=\"v$.thesis.text.$model\"></textarea>\r\n              <p style=\"color:red;\" v-if=\"v$.thesis.text.$error\">الرجاء قم بكتابة الأطروحة </p>\r\n            </div>\r\n\r\n            <div class=\"form-group  text-right\">\r\n              <label class=\"form-label\" for=\"customFile\">صورة من مجموعة السفراء (يمكنك رفع صورتين فقط)</label>\r\n              <input class=\"form-control\" type=\"file\" id=\"customFile\" ref=\"file\"\r\n                @input=\"thesis.image_1=$event.target.files[0]\" multiple />\r\n                <input class=\"form-control\" type=\"file\" id=\"customFile2\" ref=\"file\"\r\n                @input=\"thesis.image_2=$event.target.files[0]\" multiple />\r\n              <small style=\"color:red;\" v-if=\"v$.thesis.image_1.$error\"> قم برفع صورة او صورتين</small>\r\n            </div>\r\n            <hr>\r\n            <div class=\"user-post\" v-if=\"thesis.photos\">\r\n              <div class=\" d-grid grid-rows-2 grid-flow-col gap-3\">\r\n                <div class=\"row-span-2 row-span-md-1\" v-for=\"image in thesis.photos\" :key=\"image.id\">\r\n                  <img :src=\"resolve_img_url(image)\" alt=\"post-image\" class=\"img-fluid rounded w-100\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <hr>\r\n\r\n            <div class=\"col-sm-12 text-center\" v-if=\"loader\">\r\n              <img src=\"../../assets/images/page-img/page-load-loader.gif\" alt=\"loader\" style=\"height: 100px;\">\r\n            </div>\r\n            <h4 class=\"text-center mt-3 mb-3\" v-if=\"message\"> {{message}}</h4>\r\n            <div class=\"d-inline-block w-100 text-center\">\r\n              <button type=\"\" @click=\"back()\" class=\"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto\" v-if=\"message\">\r\n                عودة لصفحة الأنجاز\r\n              </button>\r\n            </div>\r\n            <input type=\"submit\" value=\"تعديل\" href=\"javascript:void(0);\" class=\"btn btn-primary d-block mt-3\" />\r\n          </form>\r\n        </div>\r\n        <div class=\"d-flex align-items-center mt-3 row\" v-else>\r\n          <h4 class=\"text-center mt-3 mb-3 col-12\"> لا يمكنك تعديل السؤال لأنه في حالة التقييم أو تم تقييمه</h4>\r\n          <div class=\"d-inline-block w-100 text-center col-12\">\r\n            <button type=\"\" @click=\"back()\" class=\"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto\">\r\n              عودة لصفحة الأنجاز\r\n            </button>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </iq-card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport thesisServices from '../../api/thesisServices';\r\nimport useVuelidate from \"@vuelidate/core\";\r\nimport { required, integer, requiredIf } from \"@vuelidate/validators\";\r\nexport default {\r\n  name: \"UpdateQuestion\",\r\n  async created() {\r\n    this.thesisToupdate = await thesisServices.getById(this.$route.params.id)\r\n    this.book = this.thesisToupdate.user_book.book\r\n    this.thesis.text = this.thesisToupdate.thesis_text;\r\n    this.thesis.ending_page = this.thesisToupdate.ending_page;\r\n    this.thesis.starting_page = this.thesisToupdate.starting_page\r\n    this.thesis.photos = this.thesisToupdate.photos;\r\n    console.log(this.thesis.photos)\r\n\r\n  },\r\n  components: {\r\n  },\r\n  setup() {\r\n    return { v$: useVuelidate() };\r\n  },\r\n  data() {\r\n    return {\r\n      loader: false,\r\n      thesis: {\r\n        text: \"\",\r\n        starting_page: \"\",\r\n        ending_page: \"\",\r\n        photos: [],\r\n        image_1:[],\r\n        image_2:[],\r\n        pages: 0,\r\n      },\r\n      book: [],\r\n      message: '',\r\n      thesisToupdate: [],\r\n    };\r\n  },\r\n  validations() {\r\n    return {\r\n      thesis: {\r\n        text: {\r\n          required,\r\n        },\r\n        starting_page: {\r\n          required,\r\n        },\r\n        ending_page: {\r\n          required,\r\n        },\r\n        image_1: {\r\n          required: requiredIf(function (nestedModel) {\r\n            return this.thesis.image_2.length == 0; // New changes\r\n          }),\r\n        },\r\n        image_2: {\r\n          required: requiredIf(function (nestedModel) {\r\n            return this.thesis.image_1.length == 0; // New changes\r\n          }),\r\n        },\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    addField(value, fieldType) {\r\n      fieldType.push({ text: \"\" });\r\n    },\r\n    removeField(index, fieldType) {\r\n      fieldType.splice(index, 1);\r\n    },\r\n    async submit() {\r\n      this.v$.$touch()\r\n      if (!this.v$.thesis.$invalid) {\r\n        this.message = \"\";\r\n        this.loader = true;\r\n        const thesis = await thesisServices.updateThesis(this.thesis, this.$route.params.id);\r\n        this.thesis.text = \"\";\r\n        this.thesis.ending_page = \"\";\r\n        this.thesis.starting_page = \"\";\r\n        this.thesis.image_1 = [];\r\n        this.thesis.image_2 = [];\r\n        this.v$.thesis.$reset();\r\n        this.loader = false;\r\n        this.message = \"تم التعديل بنجاح\"\r\n      }\r\n    },\r\n    back() {\r\n      this.$router.push({ path: `/user_book/${this.thesisToupdate.user_book_id}` })\r\n    },\r\n    resolve_img_url: function (image) {\r\n      const url = `http://127.0.0.1:8000/api/thesises/image?path=${image.path}`\r\n      return url;\r\n    },\r\n\r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}