{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/someO/Desktop/vue/osboha-template/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport questionServices from '../../api/questionServices';\nimport useVuelidate from \"@vuelidate/core\";\nimport { required, minLength, maxLength } from \"@vuelidate/validators\";\nexport default {\n  name: \"UpdateQuestion\",\n  created: function created() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return questionServices.getById(_this.$route.params.id);\n\n            case 2:\n              _this.questionToupdate = _context.sent;\n              _this.book = _this.questionToupdate.user_book.book;\n              _this.questionForm.question = _this.questionToupdate.question;\n              _this.questionForm.user_book_id = _this.questionToupdate.user_book.id;\n              _this.questionForm.starting_page = _this.questionToupdate.starting_page;\n              _this.questionForm.ending_page = _this.questionToupdate.ending_page;\n              _this.questionForm.quotes = _this.questionToupdate.quotation;\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  components: {},\n  setup: function setup() {\n    return {\n      v$: useVuelidate()\n    };\n  },\n  data: function data() {\n    return {\n      loader: false,\n      questionForm: {\n        question: '',\n        starting_page: \"\",\n        ending_page: \"\",\n        user_book_id: 0,\n        quotes: [{\n          text: ''\n        }]\n      },\n      pageError: '',\n      book: [],\n      message: null,\n      questionToupdate: []\n    };\n  },\n  validations: function validations() {\n    return {\n      questionForm: {\n        question: {\n          required: required,\n          minLength: minLength(100),\n          maxLength: maxLength(250)\n        },\n        starting_page: {\n          required: required,\n          valdiatePages: this.validatePages\n        },\n        ending_page: {\n          required: required,\n          valdiatePages: this.validatePages\n        },\n        quotes: {\n          required: required,\n          minLength: minLength(1),\n          $each: {\n            text: {\n              minLength: minLength(250)\n            }\n          }\n        }\n      }\n    };\n  },\n  methods: {\n    validatePages: function validatePages() {\n      var error = parseInt(this.questionForm.starting_page) < parseInt(this.questionForm.ending_page);\n      console.log(error);\n      if (!error) this.pageError = 'يجب ان تكون صفحة البداية اقل من صفحة النهاية';else this.pageError = '';\n      return error;\n    },\n    addField: function addField(value, fieldType) {\n      fieldType.push({\n        text: \"\"\n      });\n      console.log(fieldType);\n    },\n    removeField: function removeField(index, fieldType) {\n      fieldType.splice(-1);\n      console.log(fieldType);\n    },\n    submitQuestionUpdate: function submitQuestionUpdate() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var question;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this2.v$.$touch();\n\n                if (_this2.v$.questionForm.$invalid) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                _this2.message = \"\";\n                _this2.loader = true;\n                _context2.next = 6;\n                return questionServices.updateQuestion(_this2.questionForm, _this2.questionToupdate.id);\n\n              case 6:\n                question = _context2.sent;\n                console.log(question);\n                _this2.questionForm.question = question.question;\n                _this2.questionForm.pageEnd = question.ending_page;\n                _this2.questionForm.pageStart = question.starting_page;\n\n                _this2.v$.questionForm.$reset();\n\n                _this2.loader = false;\n                _this2.message = \"تم التعديل بنجاح\";\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    },\n    back: function back() {\n      this.$router.push({\n        path: \"/user_book/\".concat(this.questionToupdate.user_book.book.id)\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["questionServices","useVuelidate","required","minLength","maxLength","name","created","getById","$route","params","id","questionToupdate","book","user_book","questionForm","question","user_book_id","starting_page","ending_page","quotes","quotation","components","setup","v$","data","loader","text","pageError","message","validations","valdiatePages","validatePages","$each","methods","error","parseInt","console","log","addField","value","fieldType","push","removeField","index","splice","submitQuestionUpdate","$touch","$invalid","updateQuestion","pageEnd","pageStart","$reset","back","$router","path"],"sourceRoot":"","sources":["C:\\Users\\someO\\Desktop\\vue\\osboha-template\\src\\views\\Questions\\update.vue"],"sourcesContent":["<template>\r\n  <div class=\"col-sm-12 mt-3 text-center\">\r\n    <iq-card class=\"iq-card\">\r\n      <div class=\"iq-card-header-toolbar d-flex align-items-center mx-auto\">\r\n        <h3 class=\"text-center mt-3 mb-3\">\r\n          تعديل سؤال\r\n        </h3>\r\n      </div>\r\n      <div class=\"iq-card-body p-3\">\r\n        <div class=\"image-block text-center\">\r\n          <img src=\"@/assets/images/update-forms.png\" class=\"img-fluid rounded w-50\" alt=\"blog-img\">\r\n        </div>\r\n\r\n        <div class=\"d-flex align-items-center mt-3\"\r\n          v-if=\"questionToupdate.status == null || questionToupdate.status == 'rejected'  \">\r\n          <form  @submit.prevent=\"submitQuestionUpdate\" class=\"post-text ml-3 w-100 row\">\r\n            <div class=\"form-group col-6\">\r\n              <select :disabled=\"message\" v-model=\"v$.questionForm.starting_page.$model\" class=\"form-select\" data-trigger\r\n                name=\"choices-single-default\" id=\"choices-single-default\">\r\n                <option value=\"\">اختر صفحة البداية</option>\r\n                <option v-for=\"(i, index) in book.pages\" :key=\"index\" :value=\"i\">\r\n                  {{ i }}\r\n                </option>\r\n              </select>\r\n              <small style=\"color: red\" v-if=\"v$.questionForm.starting_page.$error\"\r\n                >{{pageError ? pageError :' الرجاء قم بادخال صفحة البداية'}}</small\r\n              >\r\n            </div>\r\n            <div class=\"form-group col-6\">\r\n              <select :disabled=\"message\" class=\"form-select\" v-model=\"v$.questionForm.ending_page.$model\" data-trigger\r\n                name=\"choices-single-default\" id=\"choices-single-default\">\r\n                <option value=\"\">اختر صفحة النهاية</option>\r\n                <option v-for=\"(i, index) in book.pages\" :key=\"index\" :value=\"i\">\r\n                  {{ i }}\r\n                </option>\r\n              </select>\r\n               <small style=\"color: red\" v-if=\"v$.questionForm.ending_page.$error\"\r\n                >{{pageError ? pageError :' الرجاء قم بادخال صفحة النهاية'}}</small\r\n              >\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <textarea :disabled=\"message\" rows=\"5\" placeholder=\"... اكتب سؤالًا \" class=\"rounded form-control\" id=\"bookQuestion\"\r\n                v-model=\"v$.questionForm.question.$model\"></textarea>\r\n              <small style=\"color:red;\" v-if=\"v$.questionForm.question.$error\">\r\n                لطفًا قم بكتابة سؤال عدد حروفه بين 100  و 250\r\n              </small>\r\n            </div>\r\n            <hr>\r\n            <div class=\"form-group\">\r\n              <h4>الاقتباسات</h4>\r\n              <textarea :disabled=\"message\" rows=\"5\" placeholder=\"... اكتب اقتباسًا \" v-for=\"(v,index) in questionForm.quotes\" :key=\"index\"\r\n                class=\"rounded form-control mt-2\" id=\"bookQuote\" v-model=\"v.text\">\r\n                </textarea>\r\n              <small style=\"color:red;\" v-if=\"v$.questionForm.question.$error\">\r\n                قم بادخال اقتباس واحد على الاقل عدد حروفه لا يزيد عن 250\r\n              </small>\r\n              <a  v-if='!message' class=\"btn btn-primary rounded-pill mb-3 me-1 mt-3\" @click=\"addField(textarea, questionForm.quotes)\">\r\n                اضافة اقتباس\r\n              </a>\r\n              <a v-if='!message' class=\"btn btn-danger rounded-pill mb-3 me-1 mt-3\"\r\n                v-show=\"questionForm.quotes && questionForm.quotes.length > 1\"\r\n                @click=\"removeField(index, questionForm.quotes)\">\r\n                حذف اقتباس\r\n              </a>\r\n            </div>\r\n            <hr>\r\n            <div class=\"col-sm-12 text-center\" v-if=\"loader\">\r\n              <img src=\"../../assets/images/page-img/page-load-loader.gif\" alt=\"loader\" style=\"height: 100px;\">\r\n            </div>\r\n            <h4 class=\"text-center mt-3 mb-3\" v-if=\"message\"> {{message}}</h4>\r\n            <div class=\"d-inline-block w-100 text-center\">\r\n              <button type=\"\" @click=\"back()\" class=\"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto\" v-if=\"message\">\r\n                عودة لصفحة الأنجاز\r\n              </button>\r\n              <input type=\"submit\" value=\"تعديل\" href=\"javascript:void(0);\" class=\"btn btn-primary d-block mt-3 w-100\"\r\n                v-else />\r\n            </div>\r\n          </form>\r\n        </div>\r\n        <div class=\"d-flex align-items-center mt-3 row\" v-else>\r\n          <h4 class=\"text-center mt-3 mb-3 col-12\"> لا يمكنك تعديل السؤال لأنه في حالة التقييم أو تم تقييمه</h4>\r\n          <div class=\"d-inline-block w-100 text-center col-12\">\r\n            <button type=\"\" @click=\"back()\" class=\"btn d-block btn-primary mt-3 mb-3 w-75 mx-auto\">\r\n              عودة لصفحة الأنجاز\r\n            </button>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </iq-card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport questionServices from '../../api/questionServices';\r\nimport useVuelidate from \"@vuelidate/core\";\r\nimport { required, minLength, maxLength } from \"@vuelidate/validators\";\r\nexport default {\r\n  name: \"UpdateQuestion\",\r\n  async created() {\r\n    this.questionToupdate = await questionServices.getById(this.$route.params.id)\r\n    this.book = this.questionToupdate.user_book.book\r\n    this.questionForm.question = this.questionToupdate.question\r\n    this.questionForm.user_book_id = this.questionToupdate.user_book.id\r\n    this.questionForm.starting_page = this.questionToupdate.starting_page\r\n    this.questionForm.ending_page = this.questionToupdate.ending_page\r\n    this.questionForm.quotes = this.questionToupdate.quotation\r\n  },\r\n  components: {\r\n  },\r\n  setup() {\r\n    return { v$: useVuelidate() };\r\n  },\r\n  data() {\r\n    return {\r\n      loader: false,\r\n      questionForm: {\r\n        question: '',\r\n        starting_page: \"\",\r\n        ending_page: \"\",\r\n        user_book_id:0,\r\n        quotes: [\r\n          { text: '' }\r\n        ]\r\n      },  pageError:'',\r\n      book: [],\r\n      message: null,\r\n      questionToupdate:[],\r\n    };\r\n  },\r\n  validations() {\r\n    return {\r\n      questionForm: {\r\n        question: {\r\n          required,\r\n          minLength: minLength(100),\r\n          maxLength: maxLength(250)\r\n\r\n        },  starting_page: {\r\n          required,valdiatePages:this.validatePages\r\n        },\r\n        ending_page: {\r\n          required,valdiatePages:this.validatePages\r\n        }, quotes: {\r\n          required,\r\n          minLength: minLength(1),\r\n          $each: {\r\n            text: {\r\n              minLength: minLength(250)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n       validatePages(){\r\n      const error =  parseInt(this.questionForm.starting_page) < parseInt(this.questionForm.ending_page)\r\n      console.log(error)\r\n      if(!error)this.pageError = 'يجب ان تكون صفحة البداية اقل من صفحة النهاية'\r\n      else this.pageError = ''\r\n      return error;\r\n    },\r\n    addField(value, fieldType) {\r\n      fieldType.push({ text: \"\" });\r\n       console.log(fieldType)\r\n    },\r\n    removeField(index, fieldType) {\r\n      fieldType.splice(-1);\r\n      console.log(fieldType)\r\n    },\r\n    async submitQuestionUpdate() {\r\n      this.v$.$touch(); \r\n      if (!this.v$.questionForm.$invalid) {\r\n        this.message = \"\";\r\n        this.loader = true;\r\n        const question = await questionServices.updateQuestion(this.questionForm, this.questionToupdate.id);\r\n        console.log(question)\r\n        this.questionForm.question = question.question;\r\n        this.questionForm.pageEnd = question.ending_page;\r\n        this.questionForm.pageStart = question.starting_page; \r\n        this.v$.questionForm.$reset()\r\n        this.loader = false;\r\n        this.message = \"تم التعديل بنجاح\"\r\n      }\r\n\r\n\r\n    },\r\n    back() {\r\n      this.$router.push({ path: `/user_book/${this.questionToupdate.user_book.book.id}` })\r\n    }\r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}